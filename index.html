<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>è”šæ¥å¯æœŸ</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    
    <!-- SEOä¼˜åŒ– -->
    <meta name="description" content="æ¯ä¸ªè®¾å¤‡æ‰«ç éƒ½ä¼šçœ‹åˆ°ä¸“å±çš„å›ºå®šå›¾ç‰‡">
    <meta name="keywords" content="è”šæ¥å¯æœŸ,é©¬å¹´çª—è´´,ä¸“å±å›¾ç‰‡">
    <meta name="author" content="cfelix888">
    
    <style>
        /* å®Œå…¨éšè—æ‰€æœ‰æ»šåŠ¨æ¡å’Œåœ°å€æ  */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            position: fixed;
            background: #000000;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        
        /* å›¾ç‰‡å®¹å™¨ */
        #image-container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        /* å›¾ç‰‡æ ·å¼ */
        #image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: none; /* åˆå§‹éšè— */
            opacity: 0;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: opacity;
        }
        
        #image.visible {
            display: block;
            opacity: 1;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            z-index: 100;
            background: rgba(0, 0, 0, 0.7);
            padding: 30px 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            min-width: 200px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: #4CAF50;
            border-right-color: #2196F3;
            border-bottom-color: #FF9800;
            border-left-color: #9C27B0;
            animation: spin 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 10px;
            color: #FFFFFF;
        }
        
        .device-id {
            font-size: 12px;
            color: #888888;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
            word-break: break-all;
            max-width: 250px;
        }
        
        /* è®¾å¤‡ä¿¡æ¯æ˜¾ç¤ºï¼ˆå³ä¸‹è§’ï¼‰ */
        #device-info {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: #AAAAAA;
            font-size: 11px;
            padding: 8px 12px;
            border-radius: 8px;
            backdrop-filter: blur(5px);
            display: none;
            max-width: 200px;
            word-break: break-all;
            border: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0.9;
            transition: opacity 0.3s;
        }
        
        #device-info:hover {
            opacity: 1;
        }
        
        #device-info .title {
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 3px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* åˆ·æ–°æŒ‰é’® */
        #refresh-btn {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            backdrop-filter: blur(5px);
            transition: all 0.3s;
            opacity: 0.7;
            z-index: 1000;
        }
        
        #refresh-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            opacity: 1;
            transform: rotate(90deg);
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                height: 100vh;
                min-height: -webkit-fill-available;
            }
            
            html {
                height: -webkit-fill-available;
            }
            
            #loading {
                padding: 25px 30px;
                min-width: 180px;
            }
            
            .spinner {
                width: 40px;
                height: 40px;
            }
            
            #refresh-btn {
                top: 10px;
                right: 10px;
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
            
            #device-info {
                bottom: 10px;
                right: 10px;
                font-size: 10px;
                padding: 6px 10px;
                max-width: 150px;
            }
        }
        
        /* è¶…å°å±å¹•ä¼˜åŒ– */
        @media (max-width: 360px) {
            .loading-text {
                font-size: 14px;
            }
            
            .device-id {
                font-size: 10px;
                max-width: 180px;
            }
        }
        
        /* æš—é»‘æ¨¡å¼æ”¯æŒ */
        @media (prefers-color-scheme: dark) {
            #loading {
                background: rgba(20, 20, 20, 0.9);
            }
            
            #device-info {
                background: rgba(20, 20, 20, 0.9);
            }
        }
        
        /* æ‰“å°æ ·å¼ */
        @media print {
            #loading, #refresh-btn, #device-info {
                display: none !important;
            }
            
            #image {
                opacity: 1 !important;
                display: block !important;
            }
        }
    </style>
</head>
<body>
    <!-- åˆ·æ–°æŒ‰é’® -->
    <button id="refresh-btn" title="é‡æ–°åŠ è½½å›¾ç‰‡" aria-label="é‡æ–°åŠ è½½">
        âŸ³
    </button>
    
    <!-- åŠ è½½åŠ¨ç”» -->
    <div id="loading">
        <div class="spinner"></div>
        <div class="loading-text">åŠ è½½æ‚¨çš„ä¸“å±å›¾ç‰‡</div>
        <div id="device-id-display" class="device-id">æ­£åœ¨è¯†åˆ«è®¾å¤‡...</div>
    </div>
    
    <!-- å›¾ç‰‡å®¹å™¨ -->
    <div id="image-container">
        <img id="image" alt="è”šæ¥å¯æœŸé©¬å¹´çª—è´´" crossorigin="anonymous">
    </div>
    
    <!-- è®¾å¤‡ä¿¡æ¯æ˜¾ç¤º -->
    <div id="device-info">
        <div class="title">è®¾å¤‡ä¿¡æ¯</div>
        <div id="device-info-content">åŠ è½½ä¸­...</div>
    </div>
    
    <script>
        // ==================== é…ç½®åŒºåŸŸ ====================
        const CONFIG = {
            // å›¾ç‰‡åˆ—è¡¨
            images: [
                "é©¬å¹´çª—è´´-02.jpg", 
                "é©¬å¹´çª—è´´-03.jpg",
                "é©¬å¹´çª—è´´-04.jpg",
                "é©¬å¹´çª—è´´-05.jpg",
                "é©¬å¹´çª—è´´-06.jpg",
                "é©¬å¹´çª—è´´-07.jpg",
                "é©¬å¹´çª—è´´-08.jpg",
                "é©¬å¹´çª—è´´-09.jpg",
                "é©¬å¹´çª—è´´-10.jpg",
                "é©¬å¹´çª—è´´-11.jpg"
            ],
            
            // å­˜å‚¨é”®å
            storageKeys: {
                deviceId: 'chunjie_device_id',
                assignments: 'chunjie_image_assignments',
                lastVisit: 'chunjie_last_visit'
            },
            
            // Cookieè®¾ç½®
            cookieOptions: {
                path: '/',
                maxAge: 365 * 24 * 60 * 60, // 1å¹´
                sameSite: 'Lax'
            },
            
            // è°ƒè¯•æ¨¡å¼
            debug: false
        };
        
        // ==================== å·¥å…·å‡½æ•° ====================
        
        // ç”Ÿæˆç¨³å®šçš„è®¾å¤‡ID
        function generateStableDeviceId() {
            // æ”¶é›†è®¾å¤‡æŒ‡çº¹ä¿¡æ¯ï¼ˆä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
            const fingerprintData = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                navigator.hardwareConcurrency || 'unknown',
                navigator.platform
            ].join('|');
            
            // ç®€å•å“ˆå¸Œå‡½æ•°
            function simpleHash(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash; // è½¬æ¢ä¸º32ä½æ•´æ•°
                }
                return Math.abs(hash).toString(36);
            }
            
            // ç”Ÿæˆè®¾å¤‡ID
            const timestamp = Date.now().toString(36);
            const hash = simpleHash(fingerprintData);
            const random = Math.random().toString(36).substr(2, 6);
            
            return `device_${hash}_${timestamp}_${random}`;
        }
        
        // è®¾ç½®Cookie
        function setCookie(name, value, options = {}) {
            const opts = { ...CONFIG.cookieOptions, ...options };
            let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`;
            
            if (opts.maxAge) {
                cookieString += `; max-age=${opts.maxAge}`;
            }
            
            if (opts.path) {
                cookieString += `; path=${opts.path}`;
            }
            
            if (opts.sameSite) {
                cookieString += `; samesite=${opts.sameSite}`;
            }
            
            if (opts.secure) {
                cookieString += '; secure';
            }
            
            document.cookie = cookieString;
            return true;
        }
        
        // è·å–Cookie
        function getCookie(name) {
            const nameEQ = encodeURIComponent(name) + "=";
            const cookies = document.cookie.split(';');
            
            for (let i = 0; i < cookies.length; i++) {
                let cookie = cookies[i].trim();
                if (cookie.indexOf(nameEQ) === 0) {
                    return decodeURIComponent(cookie.substring(nameEQ.length));
                }
            }
            return null;
        }
        
        // è·å–æˆ–åˆ›å»ºè®¾å¤‡ID
        function getOrCreateDeviceId() {
            // 1. å°è¯•ä»Cookieè·å–
            let deviceId = getCookie(CONFIG.storageKeys.deviceId);
            
            // 2. å°è¯•ä»LocalStorageè·å–
            if (!deviceId) {
                deviceId = localStorage.getItem(CONFIG.storageKeys.deviceId);
                if (deviceId) {
                    // åŒæ­¥åˆ°Cookie
                    setCookie(CONFIG.storageKeys.deviceId, deviceId);
                }
            }
            
            // 3. ç”Ÿæˆæ–°è®¾å¤‡ID
            if (!deviceId) {
                deviceId = generateStableDeviceId();
                
                // åŒæ—¶å­˜å‚¨åˆ°Cookieå’ŒLocalStorage
                setCookie(CONFIG.storageKeys.deviceId, deviceId);
                localStorage.setItem(CONFIG.storageKeys.deviceId, deviceId);
                
                if (CONFIG.debug) {
                    console.log('ğŸ¯ æ–°è®¾å¤‡IDç”Ÿæˆ:', deviceId);
                }
            } else {
                // ç¡®ä¿LocalStorageä¹Ÿæœ‰ï¼ˆåŒæ­¥ï¼‰
                localStorage.setItem(CONFIG.storageKeys.deviceId, deviceId);
                
                if (CONFIG.debug) {
                    console.log('ğŸ” è·å–ç°æœ‰è®¾å¤‡ID:', deviceId);
                }
            }
            
            // æ›´æ–°æœ€åè®¿é—®æ—¶é—´
            const now = Date.now();
            localStorage.setItem(CONFIG.storageKeys.lastVisit, now.toString());
            
            return deviceId;
        }
        
        // è·å–è®¾å¤‡åˆ†é…çš„å›¾ç‰‡ç´¢å¼•
        function getDeviceAssignedImageIndex(deviceId) {
            const storageKey = CONFIG.storageKeys.assignments;
            let assignments = {};
            
            // å°è¯•ä»LocalStorageè·å–åˆ†é…æ•°æ®
            try {
                const storedData = localStorage.getItem(storageKey);
                if (storedData) {
                    assignments = JSON.parse(storedData);
                }
            } catch (error) {
                console.warn('âš ï¸ è§£æåˆ†é…æ•°æ®å¤±è´¥ï¼Œä½¿ç”¨æ–°åˆ†é…:', error);
                assignments = {};
            }
            
            // æ£€æŸ¥è¯¥è®¾å¤‡æ˜¯å¦å·²æœ‰åˆ†é…
            if (assignments[deviceId] !== undefined) {
                const index = assignments[deviceId];
                
                // éªŒè¯ç´¢å¼•æ˜¯å¦æœ‰æ•ˆ
                if (index >= 0 && index < CONFIG.images.length) {
                    if (CONFIG.debug) {
                        console.log(`ğŸ“¸ è®¾å¤‡å·²æœ‰å›¾ç‰‡åˆ†é…: ç´¢å¼•=${index}, å›¾ç‰‡=${CONFIG.images[index]}`);
                    }
                    return index;
                } else {
                    console.warn('âš ï¸ æ— æ•ˆçš„å›¾ç‰‡ç´¢å¼•ï¼Œé‡æ–°åˆ†é…');
                    delete assignments[deviceId];
                }
            }
            
            // æ–°è®¾å¤‡ï¼šåˆ†é…å›ºå®šå›¾ç‰‡ï¼ˆåŸºäºè®¾å¤‡IDçš„ç¡®å®šæ€§ç®—æ³•ï¼‰
            let hash = 5381;
            for (let i = 0; i < deviceId.length; i++) {
                hash = (hash * 33) ^ deviceId.charCodeAt(i);
            }
            
            const imageIndex = (hash >>> 0) % CONFIG.images.length;
            
            // ä¿å­˜åˆ†é…
            assignments[deviceId] = imageIndex;
            
            try {
                localStorage.setItem(storageKey, JSON.stringify(assignments));
                if (CONFIG.debug) {
                    console.log(`âœ¨ æ–°è®¾å¤‡å›¾ç‰‡åˆ†é…: è®¾å¤‡=${deviceId.substring(0, 12)}..., ç´¢å¼•=${imageIndex}, å›¾ç‰‡=${CONFIG.images[imageIndex]}`);
                }
            } catch (error) {
                console.error('âŒ ä¿å­˜åˆ†é…æ•°æ®å¤±è´¥:', error);
            }
            
            return imageIndex;
        }
        
        // åŠ è½½å›¾ç‰‡
        function loadImage(imageName) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                
                img.onload = function() {
                    // ç¡®ä¿å›¾ç‰‡å®Œå…¨è§£ç 
                    if (this.complete && this.naturalWidth > 0) {
                        resolve(img);
                    } else {
                        reject(new Error('å›¾ç‰‡æœªå®Œå…¨è§£ç '));
                    }
                };
                
                img.onerror = function() {
                    reject(new Error(`å›¾ç‰‡åŠ è½½å¤±è´¥: ${imageName}`));
                };
                
                // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
                const timestamp = Date.now();
                img.src = `images/${imageName}?v=${timestamp}`;
                img.crossOrigin = "anonymous";
                
                // å¦‚æœå›¾ç‰‡å·²åœ¨ç¼“å­˜ä¸­
                if (img.complete && img.naturalWidth > 0) {
                    resolve(img);
                }
            });
        }
        
        // æ˜¾ç¤ºå›¾ç‰‡
        function displayImage(imgElement, imageObj) {
            return new Promise((resolve) => {
                imgElement.src = imageObj.src;
                
                // ä½¿ç”¨åŒç¼“å†²æŠ€æœ¯é¿å…é—ªçƒ
                setTimeout(() => {
                    imgElement.classList.add('visible');
                    resolve();
                }, 50);
            });
        }
        
        // æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯
        function showDeviceInfo(deviceId, imageIndex, imageName) {
            const infoElement = document.getElementById('device-info');
            const contentElement = document.getElementById('device-info-content');
            
            if (infoElement && contentElement) {
                const shortId = deviceId.length > 16 ? 
                    deviceId.substring(0, 8) + '...' + deviceId.substring(deviceId.length - 8) : 
                    deviceId;
                
                const infoText = `ID: ${shortId}<br>å›¾ç‰‡: ${imageName}<br>ç¼–å·: ${imageIndex + 1}/${CONFIG.images.length}`;
                contentElement.innerHTML = infoText;
                
                // å»¶è¿Ÿæ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯
                setTimeout(() => {
                    infoElement.style.display = 'block';
                }, 2000);
            }
        }
        
        // æ›´æ–°åŠ è½½çŠ¶æ€
        function updateLoadingStatus(text, deviceId = '') {
            const loadingText = document.querySelector('.loading-text');
            const deviceIdDisplay = document.getElementById('device-id-display');
            
            if (loadingText) {
                loadingText.textContent = text;
            }
            
            if (deviceIdDisplay && deviceId) {
                const displayId = deviceId.length > 20 ? 
                    deviceId.substring(0, 10) + '...' + deviceId.substring(deviceId.length - 10) : 
                    deviceId;
                // deviceIdDisplay.textContent = `è®¾å¤‡: ${displayId}`
                    ;
            }
        }
        
        // ==================== ä¸»é€»è¾‘ ====================
        
        async function initialize() {
            try {
                // æ›´æ–°åŠ è½½çŠ¶æ€
                updateLoadingStatus('æ­£åœ¨è¯†åˆ«æ‚¨çš„è®¾å¤‡...');
                
                // 1. è·å–æˆ–åˆ›å»ºè®¾å¤‡ID
                const deviceId = getOrCreateDeviceId();
                
                // 2. è·å–è®¾å¤‡åˆ†é…çš„å›¾ç‰‡ç´¢å¼•
                updateLoadingStatus('æ­£åœ¨åˆ†é…ä¸“å±å›¾ç‰‡...', deviceId);
                await new Promise(resolve => setTimeout(resolve, 500)); // å¢åŠ ä¸€ç‚¹å»¶è¿Ÿè®©ç”¨æˆ·çœ‹åˆ°çŠ¶æ€
                
                const imageIndex = getDeviceAssignedImageIndex(deviceId);
                const imageName = CONFIG.images[imageIndex];
                
                // 3. åŠ è½½å›¾ç‰‡
                updateLoadingStatus('æ–°å¹´buffæ´¾é€ä¸­...', deviceId);
                const imageElement = document.getElementById('image');
                
                try {
                    const imageObj = await loadImage(imageName);
                    
                    // 4. æ˜¾ç¤ºå›¾ç‰‡
                    updateLoadingStatus('æ˜¾ç¤ºå›¾ç‰‡...', deviceId);
                    await displayImage(imageElement, imageObj);
                    
                    // 5. éšè—åŠ è½½åŠ¨ç”»
                    const loadingElement = document.getElementById('loading');
                    loadingElement.style.opacity = '0';
                    loadingElement.style.transition = 'opacity 0.5s';
                    
                    setTimeout(() => {
                        loadingElement.style.display = 'none';
                    }, 500);
                    
                    // 6. æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯
                    showDeviceInfo(deviceId, imageIndex, imageName);
                    
                    if (CONFIG.debug) {
                        console.log('âœ… åˆå§‹åŒ–å®Œæˆ:', {
                            deviceId,
                            imageIndex,
                            imageName,
                            totalImages: CONFIG.images.length
                        });
                    }
                    
                } catch (error) {
                    console.error('âŒ å›¾ç‰‡åŠ è½½å¤±è´¥:', error);
                    updateLoadingStatus('å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•', deviceId);
                    throw error;
                }
                
            } catch (error) {
                console.error('âŒ åˆå§‹åŒ–å¤±è´¥:', error);
                updateLoadingStatus('åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢');
                
                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                const loadingElement = document.getElementById('loading');
                loadingElement.innerHTML = `
                    <div style="color: #ff6b6b; margin-bottom: 15px;">âŒ åŠ è½½å¤±è´¥</div>
                    <div style="color: #aaa; font-size: 14px; margin-bottom: 20px;">${error.message || 'æœªçŸ¥é”™è¯¯'}</div>
                    <button onclick="location.reload()" style="
                        background: #4CAF50;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 5px;
                        cursor: pointer;
                        font-size: 14px;
                    ">åˆ·æ–°é¡µé¢</button>
                `;
            }
        }
        
        // ==================== äº‹ä»¶å¤„ç† ====================
        
        // åˆ·æ–°æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById('refresh-btn').addEventListener('click', function() {
            const imageElement = document.getElementById('image');
            const currentSrc = imageElement.src;
            
            if (currentSrc) {
                // æ·»åŠ éšæœºå‚æ•°å¼ºåˆ¶é‡æ–°åŠ è½½
                const newSrc = currentSrc.replace(/\?v=\d+$/, '') + '?v=' + Date.now();
                imageElement.src = newSrc;
                
                // æ˜¾ç¤ºçŸ­æš‚æç¤º
                this.textContent = 'âœ“';
                this.style.background = '#4CAF50';
                
                setTimeout(() => {
                    this.textContent = 'âŸ³';
                    this.style.background = '';
                }, 1000);
            }
        });
        
        // é˜²æ­¢ä¸‹æ‹‰åˆ·æ–°
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
        
        // é˜²æ­¢ç¼©æ”¾
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });
        
        // å¾®ä¿¡ç‰¹æ®Šå¤„ç†
        if (/MicroMessenger/i.test(navigator.userAgent)) {
            document.addEventListener('WeixinJSBridgeReady', function() {
                try {
                    WeixinJSBridge.call('hideToolbar');
                } catch (error) {
                    console.log('å¾®ä¿¡æ¥å£è°ƒç”¨å¤±è´¥:', error);
                }
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        window.addEventListener('load', function() {
            // ç¡®ä¿é¡µé¢åœ¨é¡¶éƒ¨
            window.scrollTo(0, 0);
            
            // é˜²æ­¢æ»šåŠ¨
            window.addEventListener('scroll', function() {
                window.scrollTo(0, 0);
            });
            
            // iOSå…¨å±ä¼˜åŒ–
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                document.body.style.height = window.innerHeight + 'px';
            }
            
            // å¯åŠ¨åˆå§‹åŒ–
            setTimeout(initialize, 100);
        });
        
        // è°ƒè¯•æ¨¡å¼ï¼šæ§åˆ¶å°å‘½ä»¤
        if (CONFIG.debug) {
            window.debugChunjie = {
                // æŸ¥çœ‹å½“å‰è®¾å¤‡ID
                getDeviceId: () => getOrCreateDeviceId(),
                
                // æŸ¥çœ‹å½“å‰åˆ†é…çš„å›¾ç‰‡
                getAssignedImage: () => {
                    const deviceId = getOrCreateDeviceId();
                    const index = getDeviceAssignedImageIndex(deviceId);
                    return {
                        deviceId,
                        index,
                        imageName: CONFIG.images[index]
                    };
                },
                
                // æ¸…é™¤å½“å‰è®¾å¤‡åˆ†é…ï¼ˆé‡æ–°éšæœºï¼‰
                resetAssignment: () => {
                    const deviceId = getOrCreateDeviceId();
                    try {
                        const storageKey = CONFIG.storageKeys.assignments;
                        let assignments = JSON.parse(localStorage.getItem(storageKey) || '{}');
                        delete assignments[deviceId];
                        localStorage.setItem(storageKey, JSON.stringify(assignments));
                        console.log('âœ… å·²æ¸…é™¤å½“å‰è®¾å¤‡åˆ†é…ï¼Œåˆ·æ–°é¡µé¢å°†é‡æ–°åˆ†é…');
                        alert('å·²æ¸…é™¤å½“å‰è®¾å¤‡åˆ†é…ï¼Œåˆ·æ–°é¡µé¢å°†é‡æ–°åˆ†é…');
                    } catch (error) {
                        console.error('æ¸…é™¤å¤±è´¥:', error);
                    }
                },
                
                // æ¸…é™¤æ‰€æœ‰å­˜å‚¨
                clearAllStorage: () => {
                    localStorage.removeItem(CONFIG.storageKeys.deviceId);
                    localStorage.removeItem(CONFIG.storageKeys.assignments);
                    localStorage.removeItem(CONFIG.storageKeys.lastVisit);
                    
                    // æ¸…é™¤Cookie
                    document.cookie = `${CONFIG.storageKeys.deviceId}=; path=/; max-age=0`;
                    
                    console.log('âœ… å·²æ¸…é™¤æ‰€æœ‰å­˜å‚¨ï¼Œåˆ·æ–°é¡µé¢å°†é‡æ–°ç”Ÿæˆè®¾å¤‡ID');
                    alert('å·²æ¸…é™¤æ‰€æœ‰å­˜å‚¨');
                }
            };
            
            console.log('ğŸ”§ è°ƒè¯•æ¨¡å¼å·²å¯ç”¨');
            console.log('ğŸ“± å¯ç”¨å‘½ä»¤: debugChunjie.getDeviceId(), debugChunjie.getAssignedImage()');
        }
        
    </script>
</body>
</html>
